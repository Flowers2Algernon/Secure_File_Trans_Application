import joblib
import pandas as pd
from malware_scan.extract_pdf_features import extract_features_from_pdf

model = joblib.load("C:\PythonProject\Fullstack\malware_scan\demo_xgb_model.pkl")
columns = joblib.load("C:\PythonProject\Fullstack\malware_scan\demo_xgb_columns.pkl")


def scan_pdf(filepath):
    features = extract_features_from_pdf(filepath, columns)
    df = pd.DataFrame([features]).reindex(columns=columns, fill_value=0)
    prediction = model.predict(df)[0]
    proba = model.predict_proba(df)[0][1]  # probability of malicious
    return prediction, proba

